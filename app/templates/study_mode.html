{% extends "base.html" %}
{% block title %}背诵模式 - {{ group.name }}{% endblock %}

{% block content %}
<div class="study-header">
    <h1>{{ group.name }} - 背诵模式</h1>
    
    <!-- 新增的进度条UI，与测试模式保持一致 -->
    <div class="progress-container">
        <div class="progress-info">
            <div class="progress-label">背诵进度</div>
            <div class="progress-status">{{ current_index }}/{{ total_words }}</div>
        </div>
        <div class="progress-bar-wrapper">
            <div class="progress-bar active" style="width: {{ (current_index / total_words * 100)|round }}%;"></div>
        </div>
    </div>
    
    <p class="keyboard-hint">提示：可使用 ← → 方向键快速导航</p>
</div>

<div class="study-card">
    <div class="card-face">
        <h2>{{ word.english }}</h2>
        <p>{{ word.chinese }}</p>
    </div>
</div>

<div class="navigation">
    <div class="nav-left">
        {% if current_index > 1 %}
            <a href="?page={{ current_index - 1 }}" class="btn btn-primary" id="prev-btn">
                <i class="nav-icon">←</i> 上一个
            </a>
        {% else %}
            <span class="btn disabled">
                <i class="nav-icon">←</i> 上一个
            </span>
        {% endif %}
    </div>
    
    <div class="nav-right">
        {% if current_index < total_words %}
            <a href="?page={{ current_index + 1 }}" class="btn btn-primary" id="next-btn">
                下一个 <i class="nav-icon">→</i>
            </a>
        {% else %}
            <a href="{{ url_for('practice.complete_study', group_id=group.id) }}" class="btn btn-success" id="complete-btn">完成背诵</a>
        {% endif %}
    </div>
</div>

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 获取导航按钮
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const completeBtn = document.getElementById('complete-btn');
        
        // 监听键盘事件
        document.addEventListener('keydown', function(event) {
            // 检查是否有输入框处于聚焦状态
            if (document.activeElement.tagName === 'INPUT' || 
                document.activeElement.tagName === 'TEXTAREA') {
                return;
            }
            
            // 左方向键 - 上一个单词
            if (event.key === 'ArrowLeft' && prevBtn) {
                event.preventDefault();
                prevBtn.click();
            } 
            // 右方向键 - 下一个单词或完成
            else if (event.key === 'ArrowRight') {
                event.preventDefault();
                if (nextBtn) {
                    nextBtn.click();
                } else if (completeBtn) {
                    completeBtn.click();
                }
            }
        });
    });
</script>
{% endblock %}

{% endblock %}